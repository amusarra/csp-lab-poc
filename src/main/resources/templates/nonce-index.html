<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Quarkus CSP Demo con Qute</title>
    <!-- Preload del font: copia i file woff/woff2 in src/main/resources/META-INF/resources/fonts/ -->
    <link rel="preload" href="/fonts/awsone.woff2" as="font" type="font/woff2" crossorigin>
    <style nonce="{nonce}">
        @font-face {
            font-family: 'AWSone';
            src: url('/fonts/awsone.woff2') format('woff2'),
                 url('/fonts/awsone.woff') format('woff');
            font-weight: 100 900;
            font-style: normal;
            font-display: swap;
        }

        body {
            font-family: 'AWSone', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
    </style>
</head>
<body>
<h1>Security Demo con Qute</h1>
<p>Il Nonce generato per questa sessione è: <strong>{nonce}</strong></p>

<!-- Script legittimo con nonce - dovrebbe essere eseguito quando la policy lo permette -->
<script nonce="{nonce}">
    window.addEventListener('load', function () {
        // eseguiamo dopo il paint per essere sicuri che il DOM sia renderizzato
        requestAnimationFrame(function () {
            requestAnimationFrame(function () {
                console.log("Script legittimo eseguito con nonce: {nonce}");
            });
        });
    });
</script>

<!-- Script senza nonce: in presenza di una CSP corretta questo verrà bloccato -->
<script>
    // script dimostrativo che dovrebbe essere bloccato da CSP se policy non permette 'unsafe-inline'
    alert("XSS Attacco! Se vedi questo, la CSP non sta bloccando gli script inline non autorizzati.");
</script>
</body>
</html>
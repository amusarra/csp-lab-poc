# CSP Filter configuration
# Abilita o disabilita il filtro CSP applicato dall'applicazione
csp.filter.enabled=true
# Se true useremo l'header Content-Security-Policy-Report-Only (utile per tuning)
csp.filter.report-only=false
# Se false, se il reverse proxy ha già impostato un header CSP non lo sovrascriviamo
csp.filter.override=false
# Endpoint che riceve i report CSP
csp.filter.report-uri=/csp-report

# Policy di default (se vuota viene costruita dinamicamente nel filtro)
# È possibile usare il placeholder {nonce} per inserire il nonce generato dal filtro
# Esempio: csp.filter.default-policy=default-src 'self'; script-src 'self' 'nonce-{nonce}'; style-src 'self' 'nonce-{nonce}' 'unsafe-inline'; font-src 'self' data:; report-uri /csp-report;

# Profilo dev
# - osserva violazioni senza bloccare
%dev.quarkus.http.header."Content-Security-Policy-Report-Only".value=default-src 'self'; frame-ancestors 'none'; base-uri 'self'
%dev.quarkus.http.header."Content-Security-Policy-Report-Only".path=/*

# - imposta policy per consentire i form-action locali e bloccare tutto il resto
#%dev.quarkus.http.header."Content-Security-Policy-Report".value=form-action 'self'; default-src 'self'; frame-ancestors 'none'; base-uri 'self'
#%dev.quarkus.http.header."Content-Security-Policy-Report".path=/*

# Esempio: Test scenario header CSP multipli (Applicazione + Reverse Proxy)
# ATTENZIONE: Questa configurazione crea volutamente un conflitto per dimostrare il problema
# Decommenta per testare lo scenario di header multipli
#%dev.quarkus.http.header."Content-Security-Policy".value=default-src 'self'; script-src 'self'
#%dev.quarkus.http.header."Content-Security-Policy".path=/multiple-csp-headers
# Il reverse proxy (nginx) aggiungerà un secondo header CSP con script-src https://cdn.example.com
# Risultato: NESSUNO script potrà essere caricato (intersezione vuota)
